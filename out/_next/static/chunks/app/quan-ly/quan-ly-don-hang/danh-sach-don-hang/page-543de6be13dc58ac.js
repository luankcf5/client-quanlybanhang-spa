(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8313,6237,5017,5332,5479],{41259:function(e,t,n){Promise.resolve().then(n.bind(n,72608))},9896:function(e,t,n){"use strict";n.d(t,{QD:function(){return s},aV:function(){return o},cd:function(){return u},dz:function(){return d}});var i=n(42333),r=n(2265),l=n(92580);let a=l.Hv.bill.root,c={revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0};function d(){let{data:e,isLoading:t,error:n,isValidating:d}=(0,i.ZP)(a,l._i,c);return(0,r.useMemo)(()=>({bills:e||[],billsLoading:t,billsError:n,billsValidating:d,billsEmpty:!t&&!(null==e?void 0:e.length)}),[null==e?void 0:e.bills,n,t,d])}function o(e){let{data:t,isLoading:n,error:c,isValidating:d}=(0,i.ZP)(e?"".concat(a,"/").concat(e):null,l._i);return(0,r.useMemo)(()=>({bill:t,billLoading:n,billError:c,billValidating:d}),[t,c,n,d])}async function u(e){let{data:t}=await l.ZP.post(a,e);return t}async function s(e,t){let{data:n}=await l.ZP.patch("".concat(a,"/").concat(e),t);return n}},63477:function(e,t,n){"use strict";n.d(t,{$:function(){return o},Mz:function(){return d},wX:function(){return u}});var i=n(42333),r=n(2265),l=n(92580);let a=l.Hv.voucher.root,c={revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0};function d(){let{data:e,isLoading:t,error:n,isValidating:d}=(0,i.ZP)(a,l._i,c);return(0,r.useMemo)(()=>({vouchers:e||[],vouchersLoading:t,vouchersError:n,vouchersValidating:d,vouchersEmpty:!t&&!(null==e?void 0:e.length)}),[null==e?void 0:e.vouchers,n,t,d])}async function o(e){let{data:t}=await l.ZP.post(a,e);return t}async function u(e,t){let{data:n}=await l.ZP.patch("".concat(a,"/").concat(e),t);return n}},72608:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var i=n(57437),r=n(2265),l=n(99149),a=n(9896),c=n(84693),d=n(20501),o=n(35691),u=n(61865),s=n(89701),h=n(55303),m=n(19045),p=n(13457),g=n(76623),f=n(22079),b=n(85269),v=n(137),x=n(91797),_=n(42834),j=n(26337),Z=n(81679),w=n(63477),C=n(8653),y=n(27558);function N(){let{table_selected_row:e,table_open_form:t,setValue:n,onForm:l,onCreateNewRow:a,onUpdateRow:c}=(0,d.S)(),N=!!e,{enqueueSnackbar:P}=(0,C.Ds)(),A=o.Ry().shape({name:o.Z_().required("Bạn chưa nhập t\xean cho m\xe3 giảm gi\xe1 !"),percent:o.Z_(),price:o.Z_()}),E=(0,r.useMemo)(()=>({name:(null==e?void 0:e.name)||"",percent:(null==e?void 0:e.percent)||"",price:(null==e?void 0:e.price)||""}),[e]),I=(0,u.cI)({resolver:(0,s.X)(A),defaultValues:E}),{reset:V,setValue:M,handleSubmit:W,formState:{isSubmitting:S}}=I;(0,r.useEffect)(()=>{V(E)},[V,e,E]);let T=W(async t=>{try{if(N){let n=await (0,w.wX)(e.id,{...t});c(n),P("Đ\xe3 cập nhật dữ liệu m\xe3 giảm gi\xe1 !")}else{let e=await (0,w.$)({...t});a(e),P("Đ\xe3 th\xeam dữ liệu m\xe3 giảm gi\xe1 mới !")}V(),k()}catch(e){console.log(e),P(e.message[0]||e.message||"Đ\xe3 c\xf3 lỗi xảy ra !  Vui l\xf2ng thử lại !",{variant:"error"})}}),k=(0,r.useCallback)(()=>{n("table_selected_row",null),l(!1),V()},[l,n,V]),[O,z]=(0,r.useState)("price"),q=(0,r.useCallback)((e,t)=>{M("price",""),M("percent",""),z(t)},[M]);return(0,i.jsx)(f.Z,{fullWidth:!0,maxWidth:"sm",open:t,onClose:k,children:(0,i.jsxs)(y.ZP,{methods:I,onSubmit:T,children:[(0,i.jsx)(x.Z,{children:N?"Cập nhật dữ liệu m\xe3 giảm gi\xe1":"Th\xeam dữ liệu m\xe3 giảm gi\xe1 mới"}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)(p.Z,{spacing:2,children:[(0,i.jsx)(y.jY,{label:"T\xean m\xe3 giảm gi\xe1 :",required:!0,children:(0,i.jsx)(y.au,{name:"name",label:"Nhập t\xean m\xe3 giảm gi\xe1",placeholder:"VOUCHER01..."})}),(0,i.jsxs)(m.Z,{value:O,onChange:q,children:[(0,i.jsx)(h.Z,{label:"Giảm gi\xe1 trực tiếp",value:"price"}),(0,i.jsx)(h.Z,{label:"Giảm gi\xe1 theo phần trăm",value:"percent"})]}),"price"===O&&(0,i.jsx)(y.jY,{label:"Nhập gi\xe1 giảm :",required:!0,children:(0,i.jsx)(y.au,{name:"price",type:"number",label:"Nhập gi\xe1 giảm",placeholder:"100000...",onChange:e=>M("price",e.target.value,{shouldValidate:!0}),InputProps:{endAdornment:(0,i.jsx)(Z.Z,{position:"start",children:(0,i.jsx)(b.Z,{variant:"subtitle2",children:"VNĐ"})})}})}),"percent"===O&&(0,i.jsx)(y.jY,{label:"Nhập phần trăm giảm :",required:!0,children:(0,i.jsx)(y.au,{name:"percent",type:"number",label:"Nhập phần trăm giảm",placeholder:"100000...",onChange:e=>M("percent",e.target.value,{shouldValidate:!0}),InputProps:{endAdornment:(0,i.jsx)(Z.Z,{position:"start",children:(0,i.jsx)(b.Z,{variant:"subtitle2",children:"%"})})}})})]})}),(0,i.jsxs)(_.Z,{children:[(0,i.jsx)(g.Z,{variant:"outlined",onClick:k,children:"Huỷ bỏ"}),(0,i.jsx)(v.Z,{type:"submit",color:"primary",variant:"contained",loading:S,children:N?"Cập nhật dữ liệu":"Th\xeam dữ liệu mới"})]})]})})}var P=n(44840),A=n.n(P),E=n(65128),I=n(41689),V=n(97203);let M=[{field:"id",headerName:"Id",filterable:!1},{field:"nameinvoice",headerName:"Số đơn h\xe0ng",flex:1,minWidth:270,hideable:!1,renderCell:e=>"Đơn h\xe0ng số ".concat(e.row.id)},{field:"statusId",headerName:"Trạng th\xe1i",headerAlign:"center",align:"center",hideable:!1,filterable:!1,flex:1,minWidth:160,renderCell:e=>(0,i.jsx)(V.Z,{variant:"soft",color:1===e.row.statusId?"success":2===e.row.statusId?"primary":"error",children:1===e.row.statusId?"Đang chờ thanh to\xe1n":2===e.row.statusId?"Đ\xe3 thanh to\xe1n":"Đ\xe3 huỷ đơn h\xe0ng"})},{field:"totalProduct",headerName:"Tổng sản phẩm",flex:1,minWidth:270,renderCell:e=>"Tổng ".concat(e.row.products.length," sản phẩm")},{field:"totalPrice",headerName:"Tổng gi\xe1 trị",flex:1,minWidth:270,renderCell:e=>(0,E.e_)(A()(e.row.products,e=>e.amount*(e.product.price-e.product.discount)))},{field:"discountPrice",headerName:"Giảm gi\xe1",flex:1,minWidth:270,renderCell:e=>(0,E.e_)(e.row.discountPrice)},{type:"date",field:"createdAt",headerName:"Thời gian tạo",headerAlign:"center",align:"center",filterable:!1,flex:1,minWidth:200,valueFormatter:e=>(0,I.Mu)(e.value.createdAt),renderCell:e=>(0,I.zM)(e.row.createdAt)},{type:"date",field:"updatedAt",headerName:"Cập nhật gần nhất",headerAlign:"center",align:"center",filterable:!1,flex:1,minWidth:200,valueFormatter:e=>(0,I.Mu)(e.value.updatedAt),renderCell:e=>(0,I.zM)(e.row.updatedAt)}];function W(){let{bills:e}=(0,a.dz)(),{setValues:t}=(0,d.S)();return(0,r.useEffect)(()=>{t({table_data:e,table_column:M,table_selected:[],table_export_data:e.map(e=>({id:e.id})),table_config:{table_name:"bills",add_data:!1,add_multi_data:!1,export_data:!0,selected_data:!0,delete_multi:!1,change_status_multi:!1,active_row:!1,edit_row:!1,delete_row:!1}})},[e]),(0,i.jsxs)(c.jx,{hasContent:!0,roles:["teacher"],children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)(N,{})]})}}},function(e){e.O(0,[1425,2771,1396,4549,7212,6672,1923,7133,38,8324,1597,7709,7868,4840,2290,5243,9321,3864,7041,3840,2971,4938,1744],function(){return e(e.s=41259)}),_N_E=e.O()}]);